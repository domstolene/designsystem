{"version":3,"file":"Drawer.stories-73655821.js","sources":["../../../../packages/components/src/components/Drawer/Drawer.tokens.tsx","../../../../packages/components/src/components/Drawer/Drawer.tsx","../../../../packages/components/src/components/Drawer/DrawerGroup.tsx"],"sourcesContent":["import { ddsBaseTokens } from '@norges-domstoler/dds-design-tokens';\n\nconst { spacing } = ddsBaseTokens;\n\nconst contentContainerPaddingNumberPx =\n  spacing.SizesDdsSpacingLocalX025NumberPx;\nconst contentContainerPadding = `${contentContainerPaddingNumberPx}px`;\n\nconst container = {\n  padding: `${\n    spacing.SizesDdsSpacingLocalX1NumberPx - contentContainerPaddingNumberPx\n  }px ${\n    spacing.SizesDdsSpacingLocalX1NumberPx - contentContainerPaddingNumberPx\n  }px ${\n    spacing.SizesDdsSpacingLocalX1NumberPx - contentContainerPaddingNumberPx\n  }px ${\n    spacing.SizesDdsSpacingLocalX15NumberPx - contentContainerPaddingNumberPx\n  }px`,\n};\n\nconst contentContainer = {\n  gap: spacing.SizesDdsSpacingLocalX1,\n  padding: contentContainerPadding,\n};\n\nexport const drawerTokens = {\n  container,\n  contentContainer,\n};\n","import { forwardRef, ReactNode, RefObject, useId } from 'react';\nimport { createPortal } from 'react-dom';\nimport styled, { css } from 'styled-components';\nimport { Button } from '../Button';\nimport { Typography } from '../Typography';\nimport {\n  useCombinedRef,\n  useMountTransition,\n  useOnClickOutside,\n  useOnKeyDown,\n  useFocusTrap,\n} from '../../hooks';\nimport { drawerTokens as tokens } from './Drawer.tokens';\nimport { focusVisible } from '../../helpers/styling';\nimport { Paper } from '../../helpers';\nimport { Property } from 'csstype';\nimport { BaseComponentPropsWithChildren, getBaseHTMLProps } from '../../types';\nimport { CloseIcon } from '../../icons/tsx';\nimport { ScrollableContainer } from '../ScrollableContainer';\n\nconst { container, contentContainer } = tokens;\n\nconst getMaxWidth = (size: DrawerSize): Property.MaxWidth => {\n  if (size === 'large') return '800px';\n  else if (size === 'medium') return '600px';\n  else return '400px';\n};\n\ntype ContainerProps = {\n  placement: DrawerPlacement;\n  isOpen: boolean;\n  widthProps?: WidthProps;\n  size: DrawerSize;\n};\n\nconst Container = styled(Paper)<ContainerProps>`\n  position: fixed;\n  top: 0;\n  height: 100%;\n  display: flex;\n  flex-direction: column-reverse;\n  justify-content: flex-end;\n  min-width: 300px;\n  z-index: 100;\n  padding: ${container.padding};\n\n  ${({ size }) => css`\n    max-width: ${getMaxWidth(size)};\n  `}\n\n  ${({ widthProps }) =>\n    widthProps &&\n    css`\n      ${widthProps}\n    `}\n\n  ${({ placement, isOpen }) =>\n    placement === 'left'\n      ? css`\n          left: 0;\n          transform: ${isOpen ? 'translate(0px)' : 'translateX(-100%)'};\n        `\n      : placement === 'right'\n      ? css`\n          right: 0;\n          transform: ${isOpen ? 'translate(0px)' : 'translateX(100%)'};\n        `\n      : ''}\n\n  @media (prefers-reduced-motion: no-preference) {\n    transition: transform 0.5s;\n  }\n\n  &:focus-visible,\n  &.focus-visible {\n    ${focusVisible}\n  }\n`;\n\nconst ContentContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: ${contentContainer.gap};\n  padding: ${contentContainer.padding};\n`;\n\nconst HeaderContainer = styled.div``;\n\nconst StyledButton = styled(Button)`\n  align-self: flex-end;\n`;\n\nexport type DrawerSize = 'small' | 'medium' | 'large';\nexport type DrawerPlacement = 'left' | 'right';\nexport type WidthProps = {\n  minWidth?: Property.MinWidth<string>;\n  maxWidth?: Property.MaxWidth<string>;\n  width?: Property.Width<string>;\n};\n\nexport type DrawerProps = BaseComponentPropsWithChildren<\n  HTMLDivElement,\n  {\n    /**Størrelsen på `<Drawer />`. */\n    size?: DrawerSize;\n    /** Plasseringen til `<Drawer />`. */\n    placement?: DrawerPlacement;\n    /**Header for `<Drawer />`. Har default styling hvis verdien er en string. */\n    header?: string | ReactNode;\n    /**Spesifiserer om `<Drawer />` skal legges vises. **OBS!** nødvendig kun hvis `<DrawerGroup />` ikke er i bruk. */\n    isOpen?: boolean;\n    /**Funksjon kjørt ved lukking. **OBS!** nødvendig kun hvis `<DrawerGroup />` ikke er i bruk. */\n    onClose?: () => void;\n    /**Spesifiserer hvilken DOM node `<Drawer />` skal ha som forelder via React portal. Brukes med f.eks `document.getElementById(\"id\")` (skaper ikke ny DOM node). */\n    parentElement?: HTMLElement;\n    /**Custom props for breddehåndtering ved behov. */\n    widthProps?: WidthProps;\n    /**Ref til elementet som åpner `<Drawer />`.  **OBS!** nødvendig kun hvis `<DrawerGroup />` ikke er i bruk. */\n    triggerRef?: RefObject<HTMLElement>;\n  }\n>;\n\nexport const Drawer = forwardRef<HTMLDivElement, DrawerProps>((props, ref) => {\n  const {\n    children,\n    onClose,\n    header,\n    isOpen = false,\n    placement = 'right',\n    parentElement = document.body,\n    size = 'small',\n    triggerRef,\n    id,\n    className,\n    htmlProps,\n    ...rest\n  } = props;\n\n  const generatedId = useId();\n  const uniqueId = id ?? `${generatedId}-drawer`;\n  const hasHeader = !!header;\n  const headerId = hasHeader ? `${uniqueId}-header` : undefined;\n\n  const drawerRef = useFocusTrap<HTMLDivElement>(isOpen);\n  const combinedRef = useCombinedRef(ref, drawerRef);\n\n  useOnKeyDown(['Esc', 'Escape'], () => {\n    if (isOpen) {\n      triggerRef && triggerRef.current?.focus();\n      onClose && onClose();\n    }\n  });\n\n  const elements: (HTMLElement | null)[] = [drawerRef.current as HTMLElement];\n  if (triggerRef) elements.push(triggerRef.current);\n\n  useOnClickOutside(elements, () => isOpen && onClose && onClose());\n\n  const hasTransitionedIn = useMountTransition(isOpen, 500);\n\n  const containerProps = {\n    ...getBaseHTMLProps(uniqueId, className, htmlProps, rest),\n    placement,\n    ref: combinedRef,\n    isOpen: hasTransitionedIn && isOpen,\n    tabIndex: -1,\n    role: 'dialog',\n    'aria-labelledby': headerId,\n    size,\n  };\n\n  const headerContainerProps = {\n    id: headerId,\n  };\n\n  return isOpen || hasTransitionedIn\n    ? createPortal(\n        <Container {...containerProps} elevation={4}>\n          <ScrollableContainer>\n            <ContentContainer>\n              {hasHeader && (\n                <HeaderContainer {...headerContainerProps}>\n                  {typeof header === 'string' ? (\n                    <Typography typographyType=\"headingSans03\">\n                      {header}\n                    </Typography>\n                  ) : (\n                    header\n                  )}\n                </HeaderContainer>\n              )}\n              {children}\n            </ContentContainer>\n          </ScrollableContainer>\n          <StyledButton\n            data-testid=\"drawer-close-btn\"\n            size=\"small\"\n            purpose=\"secondary\"\n            appearance=\"borderless\"\n            onClick={onClose}\n            aria-label=\"Lukk\"\n            icon={CloseIcon}\n          />\n        </Container>,\n        parentElement\n      )\n    : null;\n});\n\nDrawer.displayName = 'Drawer';\n","import {\n  ReactNode,\n  Children as ReactChildren,\n  isValidElement,\n  cloneElement,\n  ReactElement,\n  useState,\n  useRef,\n  useId,\n} from 'react';\n\nexport type DrawerGroupProps = {\n  /**Barna til komponenten. */\n  children: ReactNode;\n  /**`id` til `<Drawer />`. */\n  drawerId?: string;\n  /**Ekstra logikk som kjøres når `<Drawer />` åpnes. */\n  onOpen?: () => void;\n  /**Ekstra logikk som kjøres når `<Drawer />` lukkes. */\n  onClose?: () => void;\n};\n\nexport const DrawerGroup = ({\n  children,\n  drawerId,\n  onOpen,\n  onClose,\n}: DrawerGroupProps) => {\n  const generatedId = useId();\n  const uniqueDrawerId = drawerId ?? `${generatedId}-drawer`;\n\n  const buttonRef = useRef<HTMLElement>(null);\n\n  const [closed, setClosed] = useState(true);\n  const open = () => setClosed(false);\n  const close = () => setClosed(true);\n\n  const handleOpen = () => {\n    open();\n    onOpen && onOpen();\n  };\n\n  const handleClose = () => {\n    close();\n    onClose && onClose();\n  };\n\n  const Children = ReactChildren.map(children, (child, childIndex) => {\n    return (\n      isValidElement(child) &&\n      (childIndex === 0\n        ? cloneElement(child as ReactElement, {\n            'aria-haspopup': 'dialog',\n            'aria-controls': uniqueDrawerId,\n            'aria-expanded': !closed,\n            ref: buttonRef,\n            onClick: handleOpen,\n          })\n        : cloneElement(child as ReactElement, {\n            id: uniqueDrawerId,\n            triggerRef: buttonRef,\n            isOpen: !closed,\n            onClose: handleClose,\n          }))\n    );\n  });\n  return <> {Children} </>;\n};\n\nDrawerGroup.displayName = 'DrawerGroup';\n"],"names":["spacing","ddsBaseTokens","contentContainerPaddingNumberPx","contentContainerPadding","container","contentContainer","drawerTokens","tokens","getMaxWidth","size","Container","styled","Paper","css","widthProps","placement","isOpen","focusVisible","ContentContainer","HeaderContainer","StyledButton","Button","Drawer","forwardRef","props","ref","children","onClose","header","parentElement","triggerRef","id","className","htmlProps","rest","generatedId","useId","uniqueId","hasHeader","headerId","drawerRef","useFocusTrap","combinedRef","useCombinedRef","useOnKeyDown","_a","elements","useOnClickOutside","hasTransitionedIn","useMountTransition","containerProps","getBaseHTMLProps","headerContainerProps","createPortal","jsxs","jsx","ScrollableContainer","Typography","CloseIcon","DrawerGroup","drawerId","onOpen","uniqueDrawerId","buttonRef","useRef","closed","setClosed","useState","open","close","handleOpen","handleClose","Children","ReactChildren","child","childIndex","isValidElement","cloneElement","Fragment"],"mappings":"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"}