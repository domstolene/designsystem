{"version":3,"file":"useFloatPosition-f4d76573.js","sources":["../../../../packages/components/src/hooks/useFloatPosition.tsx"],"sourcesContent":["import {\n  arrow,\n  autoUpdate,\n  Coords,\n  flip,\n  offset as floatingOffset,\n  shift,\n  Strategy,\n  useFloating,\n} from '@floating-ui/react-dom';\nimport { ddsBaseTokens } from '@norges-domstoler/dds-design-tokens';\n\nconst defaultOffset = ddsBaseTokens.spacing.SizesDdsSpacingLocalX05NumberPx;\n\nexport type Placement =\n  | 'top'\n  | 'top-start'\n  | 'top-end'\n  | 'bottom'\n  | 'bottom-start'\n  | 'bottom-end'\n  | 'right'\n  | 'right-start'\n  | 'right-end'\n  | 'left'\n  | 'left-start'\n  | 'left-end';\n\ninterface UseFloatPositionOptions {\n  /**\n   * Whether to update the position of the floating element on every animation frame if required.\n   * This is optimized for performance but can still be costly.\n   * @default true\n   */\n  animationFrame?: boolean;\n  /**\n   * `offset` is used to displace the floating element from its core placement.\n   * The value passed is logical, meaning its effect on the\n   * physical result is dependent on the writing direction (e.g. RTL).\n   * @default 8\n   */\n  offset?: number;\n  /**\n   * Where to place the floating element relative to its reference element.\n   * @default 'bottom'\n   */\n  placement?: Placement;\n}\n\nexport const useFloatPosition = (\n  arrowRef: HTMLElement | null,\n  options: UseFloatPositionOptions = {}\n) => {\n  const {\n    animationFrame = true,\n    offset = defaultOffset,\n    placement = 'bottom',\n  } = options;\n\n  const middleware = [\n    floatingOffset(offset),\n    flip(),\n    shift(),\n\n    // Only add arrow(...) if arrowRef is set\n    ...(arrowRef ? [arrow({ element: arrowRef })] : []),\n  ];\n\n  const {\n    x,\n    y,\n    reference,\n    floating,\n    strategy,\n    middlewareData,\n    placement: actualPlacement,\n    refs,\n  } = useFloating({\n    placement,\n    middleware,\n    whileElementsMounted: (reference, floating, update) =>\n      autoUpdate(reference, floating, update, { animationFrame }),\n  });\n\n  return {\n    reference,\n    floating,\n    refs,\n    styles: {\n      floating: {\n        position: strategy,\n        top: y ?? '',\n        left: x ?? '',\n      },\n      arrow: middlewareData.arrow\n        ? getArrowStyling(strategy, actualPlacement, middlewareData.arrow)\n        : undefined,\n    },\n  };\n};\n\ntype Arrow = Partial<Coords> & { centerOffset: number };\n\nfunction getArrowStyling(\n  strategy: Strategy,\n  placement: Placement,\n  arrow: Arrow\n) {\n  const arrowPlacement = placementToArrowPlacement(placement);\n\n  const arrowPlacementOffset = {\n    top: '-15px',\n    bottom: '-15px',\n    right: '-21px',\n    left: '-21px',\n  }[arrowPlacement];\n\n  const rotateArrow = {\n    top: 'rotate(180deg)',\n    right: 'rotate(-90deg)',\n    bottom: '',\n    left: 'rotate(90deg)',\n  }[arrowPlacement];\n\n  return {\n    position: strategy,\n    top: arrow?.y ?? '',\n    left: arrow?.x ?? '',\n    [arrowPlacement]: arrowPlacementOffset,\n    transform: rotateArrow,\n  };\n}\n\nfunction placementToArrowPlacement(placement: Placement) {\n  switch (placement) {\n    case 'top':\n    case 'top-start':\n    case 'top-end':\n      return 'bottom';\n\n    case 'bottom':\n    case 'bottom-start':\n    case 'bottom-end':\n      return 'top';\n\n    case 'left':\n    case 'left-start':\n    case 'left-end':\n      return 'right';\n\n    case 'right':\n    case 'right-start':\n    case 'right-end':\n      return 'left';\n  }\n}\n"],"names":["defaultOffset","ddsBaseTokens","useFloatPosition","arrowRef","options","animationFrame","offset","placement","middleware","floatingOffset","flip","shift","arrow","x","y","reference","floating","strategy","middlewareData","actualPlacement","refs","useFloating","update","autoUpdate","getArrowStyling","arrowPlacement","placementToArrowPlacement","arrowPlacementOffset","rotateArrow"],"mappings":"sMAYA,MAAMA,EAAgBC,EAAc,QAAQ,gCAqC/BC,EAAmB,CAC9BC,EACAC,EAAmC,KAChC,CACG,KAAA,CACJ,eAAAC,EAAiB,GACjB,OAAAC,EAASN,EACT,UAAAO,EAAY,QACV,EAAAH,EAEEI,EAAa,CACjBC,EAAeH,CAAM,EACrBI,EAAK,EACLC,EAAM,EAGN,GAAIR,EAAW,CAACS,EAAM,CAAE,QAAST,CAAS,CAAC,CAAC,EAAI,CAAC,CAAA,EAG7C,CACJ,EAAAU,EACA,EAAAC,EACA,UAAAC,EACA,SAAAC,EACA,SAAAC,EACA,eAAAC,EACA,UAAWC,EACX,KAAAC,GACEC,EAAY,CACd,UAAAd,EACA,WAAAC,EACA,qBAAsB,CAACO,EAAWC,EAAUM,IAC1CC,EAAWR,EAAWC,EAAUM,EAAQ,CAAE,eAAAjB,EAAgB,CAAA,CAC7D,EAEM,MAAA,CACL,UAAAU,EACA,SAAAC,EACA,KAAAI,EACA,OAAQ,CACN,SAAU,CACR,SAAUH,EACV,IAAKH,GAAK,GACV,KAAMD,GAAK,EACb,EACA,MAAOK,EAAe,MAClBM,EAAgBP,EAAUE,EAAiBD,EAAe,KAAK,EAC/D,MACN,CAAA,CAEJ,EAIA,SAASM,EACPP,EACAV,EACAK,EACA,CACM,MAAAa,EAAiBC,EAA0BnB,CAAS,EAEpDoB,EAAuB,CAC3B,IAAK,QACL,OAAQ,QACR,MAAO,QACP,KAAM,SACNF,CAAc,EAEVG,EAAc,CAClB,IAAK,iBACL,MAAO,iBACP,OAAQ,GACR,KAAM,iBACNH,CAAc,EAET,MAAA,CACL,SAAUR,EACV,KAAKL,GAAAA,YAAAA,EAAO,IAAK,GACjB,MAAMA,GAAAA,YAAAA,EAAO,IAAK,GAClB,CAACa,CAAc,EAAGE,EAClB,UAAWC,CAAA,CAEf,CAEA,SAASF,EAA0BnB,EAAsB,CACvD,OAAQA,EAAW,CACjB,IAAK,MACL,IAAK,YACL,IAAK,UACI,MAAA,SAET,IAAK,SACL,IAAK,eACL,IAAK,aACI,MAAA,MAET,IAAK,OACL,IAAK,aACL,IAAK,WACI,MAAA,QAET,IAAK,QACL,IAAK,cACL,IAAK,YACI,MAAA,MACX,CACF"}