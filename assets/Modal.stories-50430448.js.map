{"version":3,"file":"Modal.stories-50430448.js","sources":["../../../../packages/components/src/components/Modal/Modal.tokens.tsx","../../../../packages/components/src/components/Modal/Backdrop/Backdrop.tsx","../../../../packages/components/src/components/Modal/Backdrop/Backdrop.utils.tsx","../../../../packages/components/src/components/Modal/Modal.tsx","../../../../packages/components/src/components/Modal/ModalBody.tsx","../../../../packages/components/src/components/Modal/ModalActions.tsx"],"sourcesContent":["import { ddsBaseTokens } from '@norges-domstoler/dds-design-tokens';\n\nconst { spacing } = ddsBaseTokens;\n\nconst container = {\n  padding: `${spacing.SizesDdsSpacingLocalX1} ${spacing.SizesDdsSpacingLocalX1} ${spacing.SizesDdsSpacingLocalX15} ${spacing.SizesDdsSpacingLocalX15}`,\n};\n\nconst contentContainer = {\n  paddingRight: spacing.SizesDdsSpacingLocalX1,\n  gap: spacing.SizesDdsSpacingLocalX1,\n};\nconst actionsContainer = {\n  gap: spacing.SizesDdsSpacingLocalX1,\n};\n\nexport const modalTokens = {\n  container,\n  contentContainer,\n  actionsContainer,\n};\n","import styled from 'styled-components';\nimport { ddsBaseTokens } from '@norges-domstoler/dds-design-tokens';\nimport { changeRGBAAlpha } from '@norges-domstoler/dds-core';\n\ntype BackdropProps = { isOpen: boolean };\n\nexport const Backdrop = styled.div<BackdropProps>`\n  position: fixed;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: ${changeRGBAAlpha(\n    ddsBaseTokens.colors.DdsColorNeutralsGray9,\n    0.5\n  )};\n  overflow-y: auto;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 200;\n  opacity: ${({ isOpen }) => (isOpen ? 1 : 0)};\n  @media (prefers-reduced-motion: no-preference) {\n    transition: opacity 0.2s;\n  }\n`;\n","const isVerticalScrollbarDisplayed = (container: HTMLElement) =>\n  container.clientHeight > window.innerHeight;\n\nexport function handleElementWithBackdropMount(container: HTMLElement) {\n  if (isVerticalScrollbarDisplayed(container)) {\n    const scrollY = Math.round(window.scrollY);\n\n    container.style.overflowY = 'scroll';\n    container.style.position = 'fixed';\n    container.style.top = `-${scrollY}px`;\n  }\n}\n\nexport function handleElementWithBackdropUnmount(container: HTMLElement) {\n  const scrollY = parseInt(document.body.style.top) || 0;\n\n  container.style.removeProperty('overflow-y');\n  container.style.removeProperty('position');\n  container.style.removeProperty('top');\n\n  window.scrollTo(0, scrollY * -1);\n}\n","import { forwardRef, ReactNode, RefObject, useEffect, useId } from 'react';\nimport styled from 'styled-components';\nimport { Button } from '../Button';\nimport { modalTokens as tokens } from './Modal.tokens';\nimport { createPortal } from 'react-dom';\nimport { Typography } from '@norges-domstoler/dds-typography';\nimport {\n  useCombinedRef,\n  useOnClickOutside,\n  useOnKeyDown,\n  Paper,\n  selection,\n  useMountTransition,\n  useFocusTrap,\n  BaseComponentPropsWithChildren,\n  getBaseHTMLProps,\n} from '@norges-domstoler/dds-core';\nimport { CloseIcon } from '@norges-domstoler/dds-icons';\nimport { focusVisible } from '@norges-domstoler/dds-form';\n\nimport {\n  handleElementWithBackdropMount,\n  handleElementWithBackdropUnmount,\n  Backdrop,\n} from './Backdrop';\n\nconst { container, contentContainer } = tokens;\n\nconst Container = styled(Paper)`\n  display: flex;\n  flex-direction: column-reverse;\n  min-width: 200px;\n  padding: ${container.padding};\n  &::selection,\n  *::selection {\n    ${selection}\n  }\n  :focus-visible,\n  &.focus-visible {\n    ${focusVisible}\n  }\n`;\nconst ContentContainer = styled.div`\n  display: grid;\n  padding-right: ${contentContainer.paddingRight};\n  gap: ${contentContainer.gap};\n`;\nconst HeaderContainer = styled.div``;\n\nconst StyledButton = styled(Button)`\n  align-self: flex-end;\n`;\n\nexport type ModalProps = BaseComponentPropsWithChildren<\n  HTMLDivElement,\n  {\n    /**Spesifiserer om modal skal vises. */\n    isOpen?: boolean;\n    /**Funksjon kjørt ved lukking; Settes hvis modal skal være lukkbar. Legger en lukkeknapp i hjørnet og kjøres ved Esc-trykk, lukkeknappklikk og museklikk utenfor. */\n    onClose?: () => void;\n    /**Spesifiserer hvilken DOM node `<Modal />` skal ha som forelder via React portal. Brukes med f.eks `document.getElementById(\"id\")` (skaper ikke ny DOM node). */\n    parentElement?: HTMLElement;\n    /**Tittel/header i modal. Setter `aria-labelledby`. */\n    header?: string | ReactNode;\n    /**Ref som brukes til returnering av fokus. */\n    triggerRef?: RefObject<HTMLElement>;\n  }\n>;\n\nexport const Modal = forwardRef<HTMLDivElement, ModalProps>((props, ref) => {\n  const {\n    isOpen = false,\n    parentElement = document.body,\n    children,\n    header,\n    onClose,\n    id,\n    triggerRef,\n    className,\n    htmlProps,\n    ...rest\n  } = props;\n  const generatedId = useId();\n  const modalId = id ?? `${generatedId}-modal`;\n  const headerId = `${modalId}-header`;\n\n  const modalRef = useFocusTrap<HTMLDivElement>(isOpen);\n  const combinedRef = useCombinedRef(ref, modalRef);\n  const handleClose = () => {\n    if (onClose && isOpen) {\n      triggerRef && triggerRef.current?.focus();\n      onClose();\n    }\n  };\n\n  useEffect(() => {\n    if (isOpen) {\n      handleElementWithBackdropMount(document.body);\n    } else {\n      handleElementWithBackdropUnmount(document.body);\n    }\n\n    return () => handleElementWithBackdropUnmount(document.body);\n  }, [isOpen]);\n\n  useOnClickOutside(modalRef.current, () => handleClose());\n\n  useOnKeyDown(['Escape', 'Esc'], () => handleClose());\n\n  const hasTransitionedIn = useMountTransition(isOpen, 200);\n\n  const backdropProps = {\n    isOpen: hasTransitionedIn && isOpen,\n  };\n\n  const containerProps = {\n    ...getBaseHTMLProps(id, className, htmlProps, rest),\n    ref: combinedRef,\n    role: 'dialog',\n    'aria-modal': true,\n    'aria-hidden': !isOpen,\n    tabIndex: -1,\n    'aria-labelledby': headerId,\n    id: modalId,\n  };\n\n  const headerContainerProps = {\n    id: headerId,\n  };\n\n  return isOpen || hasTransitionedIn\n    ? createPortal(\n        <Backdrop {...backdropProps}>\n          <Container {...containerProps} elevation={4}>\n            <ContentContainer>\n              {header && (\n                <HeaderContainer {...headerContainerProps}>\n                  {typeof header === 'string' ? (\n                    <Typography typographyType=\"headingSans03\">\n                      {header}\n                    </Typography>\n                  ) : (\n                    header\n                  )}\n                </HeaderContainer>\n              )}\n              {children}\n            </ContentContainer>\n            {onClose && (\n              <StyledButton\n                size=\"small\"\n                appearance=\"borderless\"\n                purpose=\"secondary\"\n                icon={CloseIcon}\n                onClick={handleClose}\n                aria-label=\"Lukk dialog\"\n              />\n            )}\n          </Container>\n        </Backdrop>,\n        parentElement\n      )\n    : null;\n});\n\nModal.displayName = 'Modal';\n","import { forwardRef } from 'react';\nimport styled from 'styled-components';\nimport {\n  BaseComponentPropsWithChildren,\n  getBaseHTMLProps,\n} from '@norges-domstoler/dds-core';\nimport { ScrollableContainer } from '../ScrollableContainer';\nimport { Property } from 'csstype';\n\nconst Container = styled.div``;\n\nexport type ModalBodyProps = BaseComponentPropsWithChildren<\n  HTMLDivElement,\n  {\n    /**Gjør at innholdet kan scrolles. Det må eventuelt settes (max)bredde og (max)høyde styling på både denne subkomponenten og `<Modal />`.  */\n    scrollable?: boolean;\n    /**Høyde på container. */\n    height?: Property.Height;\n  }\n>;\n\nexport const ModalBody = forwardRef<HTMLDivElement, ModalBodyProps>(\n  (props, ref) => {\n    const { children, scrollable, id, className, htmlProps, height, ...rest } =\n      props;\n\n    const containerProps = {\n      ...getBaseHTMLProps(id, className, htmlProps, rest),\n      ref,\n    };\n\n    return scrollable ? (\n      <Container {...containerProps}>\n        <ScrollableContainer contentHeight={height}>\n          {children}\n        </ScrollableContainer>\n      </Container>\n    ) : (\n      <Container {...containerProps}>{children}</Container>\n    );\n  }\n);\n\nModalBody.displayName = 'ModalBody';\n","import { forwardRef, HTMLAttributes } from 'react';\nimport styled from 'styled-components';\nimport { modalTokens as tokens } from './Modal.tokens';\n\nconst Container = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  gap: ${tokens.actionsContainer.gap};\n`;\n\nexport type ModalActionsProps = HTMLAttributes<HTMLDivElement>;\n\nexport const ModalActions = forwardRef<HTMLDivElement, ModalActionsProps>(\n  ({ children, ...rest }, ref) => {\n    const containerProps = {\n      ref,\n      ...rest,\n    };\n\n    return <Container {...containerProps}>{children}</Container>;\n  }\n);\n\nModalActions.displayName = 'ModalActions';\n"],"names":["spacing","ddsBaseTokens","container","contentContainer","actionsContainer","modalTokens","Backdrop","styled","changeRGBAAlpha","isOpen","isVerticalScrollbarDisplayed","handleElementWithBackdropMount","scrollY","handleElementWithBackdropUnmount","tokens","Container","Paper","selection","focusVisible","ContentContainer","HeaderContainer","StyledButton","Button","Modal","forwardRef","props","ref","parentElement","children","header","onClose","id","triggerRef","className","htmlProps","rest","generatedId","useId","modalId","headerId","modalRef","useFocusTrap","combinedRef","useCombinedRef","handleClose","_a","useEffect","useOnClickOutside","useOnKeyDown","hasTransitionedIn","useMountTransition","backdropProps","containerProps","getBaseHTMLProps","headerContainerProps","createPortal","jsx","jsxs","Typography","CloseIcon","ModalBody","scrollable","height","ScrollableContainer","ModalActions"],"mappings":"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"}