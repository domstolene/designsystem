import {
  Meta,
  ArgsTable,
  PRIMARY_STORY,
  Story,
  Canvas
} from '@storybook/addon-docs';
import { Popover, PopoverGroup } from '.';
import { Source, ComponentLinkRow, SB_DESIGNSYSTEM_URL } from '../../storybook';
import { Typography } from '../Typography';

<Meta title="Design system/Popover/API" component={Popover} />

# Popover

<ComponentLinkRow
  docsHref="https://design.domstol.no/987b33f71/p/185219-popover/b/656a67"
  figmaHref="https://www.figma.com/file/ewqSDmkgqDQ5PyOsRp4V5b/?node-id=4988%3A128366"
  githubHref="https://github.com/domstolene/designsystem/tree/master/components/src/components/Popover"
/>

## Demo

<Canvas>
  <Story id="design-system-popover--default" height="350px" />
</Canvas>

Se stories med kontrollere i <Typography externalLink typographyType="a" href={`${SB_DESIGNSYSTEM_URL}-popover`}>Storybook</Typography>.

## Oversikt

Komponenten består av tre elementer:

- **`<PopoverGroup />`** - wrapper for to barn: et anchor-element som styrer popover og selve popover-elementet: `<Popover />`.
- **Anchor-element**, som er også et trigger-element. Et valgfritt interaktivt element, typisk en knapp, som åpner og lukker popover. Elementet får attributtene `onClick`, `ref`, `aria-haspopup` og `aria-controls` fra `<PopoverGroup />`.
- **`<Popover />`** - en komponent som dukker opp via museklikk på anchor-elementet. Får enkelte props fra `<PopoverGroup />` som ikke kan overskrives.

## Bruk i koden

<Source code={`import { Button, Popover, PopoverGroup } from '@norges-domstoler/dds-components';

<PopoverGroup>
  <Button label="Åpne" />
  <Popover title="Tittel">Dette er en popover</Popover>
</PopoverGroup>
`} />

## API

### PopoverGroup

Wrapper der anchor-elementet skal være første barnet og `<Popover />` skal være andre barnet. `<PopoverGroup />` har to funksjoner:

- Håndtering av barnas oppførsel: åpning og lukking av popover, eventuelle ekstra callbacks.
- Automatisk forplanting av enkelte props hos barna: referanse til anchor-elementet for å simplifisere bruken av komponenten, aria-attributter for å oppfylle brukervennlighetskrav osv.

`<PopoverGroup />` returnerer kun barna uten en HTML-tag rundt dem.

**OBS!** all kontroll av `<Popover />` som onClick events implementeres i `<PopoverGroup />`, ikke direkte i `<Popover />`.

<ArgsTable of={PopoverGroup} />

### Popover

Selve popover-elementet. Den åpnes når anchor-elementet trykkes, og den lukkes ved å trykke på anchor-elementet igjen, Esc-tast, lukkeknapptrykk og onBlur.

<ArgsTable story={PRIMARY_STORY} />
I tillegg støttes alle native HTML-attributter som er en del av `HTMLAttributes<HTMLDivElement>`-interface. **OBS!** `id` er ekskludert da den blir sendt som prop fra <PopoverGroup /> for å sørge for riktig oppførsel. `id` settes via `<PopoverGroup />` `popoverId`-prop.

#### Types

<Source
  code={`
export type PopoverSizeProps = {
  width?: CSS.Property.Width<string>;
  height?: CSS.Property.Height<string>;
  minWidth?: CSS.Property.MinWidth<string>;
  minHeight?: CSS.Property.MinHeight<string>;
  maxWidth?: CSS.Property.MaxWidth<string>;
  maxHeight?: CSS.Property.MaxHeight<string>;
};
`}
/>

#### Overflow

Det kan være relevant å begrense størrelsen på Popover slik at ikke hele teksten vises ved overflow. Da bør den synlige teksten avsluttes med en ellipse:

<Canvas>
  <Story height="350px" id="design-system-popover--overflow" />
</Canvas>
For å oppnå det kan du sette sizeProps til ønskede verdier og gi tekstelementet som
er barnet i <Popover /> følgende CSS:

<Source
  language="css"
  code={`
text-overflow: ellipsis;
overflow: hidden;
white-space: nowrap;
`}
/>
