import { Story, Canvas, Meta, Controls } from '@storybook/blocks';
import {
  Source,
  ComponentLinkRow,

} from '@norges-domstoler/storybook-components';
import { Link } from '../Typography';
import { Table } from '../Table';

import * as SelectStories from './Select.stories';
import * as MultiSelectStories from './MultiSelect.stories';

<Meta title="dds-components/Select/Docs" />

# Select

<ComponentLinkRow
  docsHref="https://design.domstol.no/987b33f71/p/19970c-select/b/98ef83"
  figmaHref="https://www.figma.com/file/ewqSDmkgqDQ5PyOsRp4V5b/?node-id=155%3A38"
  githubHref="https://github.com/domstolene/designsystem/tree/main/packages/components/src/components/Select"
/>

## Oversikt

Komponenten har tre varianter:

- **`<Select />`** - nedtrekksliste
- **`<Select isMulti />`** - nedtrekksliste med multivalg
- **Custom `<Select />`** - nedtrekksliste med custom visuelle elementer for både det valgte elemetet og alternativer i lista

## API

Komponenten bruker <Link href="https://react-select.com/home" external>React-select</Link>. Det støttes props definert i designsystemet (Elsa props) og native React-select props.

<Canvas of={SelectStories.Default} sourceState="shown" />

### Elsa props

Tabellen inkluderer native props som brukes til styling.

<Controls of={SelectStories.Default} />

### Native React-select props

Ofte brukt native props:

<Table.Wrapper>
  <Table density="compact" style={{ width: '100%' }}>
    <Table.Head>
      <Table.Row type="head">
        <Table.Cell type="head">Property</Table.Cell>
        <Table.Cell type="head">Datatype</Table.Cell>
        <Table.Cell type="head">Påkrevd</Table.Cell>
        <Table.Cell type="head">Default</Table.Cell>
        <Table.Cell type="head">Beskrivelse</Table.Cell>
      </Table.Row>
    </Table.Head>

    <Table.Body>
      <Table.Row>
        <Table.Cell> `options` </Table.Cell>
        <Table.Cell> `{ label: string, value: string }[]` </Table.Cell>
        <Table.Cell>nei </Table.Cell>
        <Table.Cell>-</Table.Cell>
        <Table.Cell>Alternativer som havner i nedtrekkslisten. </Table.Cell>
      </Table.Row>

      <Table.Row>
        <Table.Cell> `onChange` </Table.Cell>
        <Table.Cell> `(newValue: { label: string, value: string } | null, ActionMeta: ActionMeta<TOption>) => void` </Table.Cell>
        <Table.Cell>nei </Table.Cell>
        <Table.Cell>-</Table.Cell>
        <Table.Cell> onChange funksjon.</Table.Cell>
      </Table.Row>


      <Table.Row>
        <Table.Cell> `value` </Table.Cell>
        <Table.Cell> `{ label: string; value: string; } | null` </Table.Cell>
        <Table.Cell>nei </Table.Cell>
        <Table.Cell>-</Table.Cell>

        <Table.Cell>
          Forhåndsvalgt alternativ som brukeren ikke kan endre.
        </Table.Cell>
      </Table.Row>

      <Table.Row>
        <Table.Cell> `defaultValue` </Table.Cell>
        <Table.Cell> `{ label: string; value: string; } | null` </Table.Cell>
        <Table.Cell>nei </Table.Cell>
        <Table.Cell>-</Table.Cell>

        <Table.Cell>
          Forhåndsvalgt alternativ som brukeren kan endre. **OBS!** Brukes ikke i standard skjema da brukeren skal ta et bevisst valg.
        </Table.Cell>
      </Table.Row>

      <Table.Row>
        <Table.Cell> `isMulti` </Table.Cell>
        <Table.Cell> `boolean` </Table.Cell>
        <Table.Cell>nei </Table.Cell>
        <Table.Cell>-</Table.Cell>
        <Table.Cell>Gjør komponenten om til multiselect.</Table.Cell>
      </Table.Row>

      <Table.Row>
        <Table.Cell> `closeMenuOnSelect` </Table.Cell>
        <Table.Cell> `boolean` </Table.Cell>
        <Table.Cell>nei </Table.Cell>
        <Table.Cell>false ved isMulti, true ellers</Table.Cell>
        <Table.Cell>Spesifiserer om listen med alternativer skal lukkes når brukeren har valgt en alternativ.</Table.Cell>
      </Table.Row>


      <Table.Row>
        <Table.Cell> `isSearchable` </Table.Cell>
        <Table.Cell> `boolean` </Table.Cell>
        <Table.Cell>nei </Table.Cell>
        <Table.Cell>`true`</Table.Cell>
        <Table.Cell>Spesifiserer om brukeren kan søke på alternativene.</Table.Cell>
      </Table.Row>
    </Table.Body>

  </Table>
</Table.Wrapper>

<br />

Full liste over props er tilgjengelig i <Link href="https://react-select.com/props" external>react-select API</Link>.

I tillegg støttes alle native HTML-attributter som er en del av `HTMLAttributes<HTMLDivElement>`-interface.

### Filtrering

Brukeren kan filtrere alternativer ved å gi tekstlig input. Det brukes en custom filtreringsfunksjon der søkeordet er enten først i teksten, eller så har det mellomrom, bindestrek eller start-parentes før seg.

### Multiselect

<Canvas of={MultiSelectStories.Default} sourceState="shown" />
<Controls of={MultiSelectStories.Default} />

#### Bredde ved `isMulti`

Komponenten har default bredde. Dette gjør at valgte alternativer ved `isMulti` vil prøve å fylle opp bredden og videre legge seg nedover. Hvis det er ønsket at komponenten skal utvide seg i bredden når flere alternativer blir valgt bør det settes f.eks. `width='fit-content'` og `min-width` i styling:

<Canvas of={MultiSelectStories.WithFitContent} sourceState="shown" />

#### Med verdi

<Canvas of={MultiSelectStories.WithValue} sourceState="shown" />

#### Med default verdi

<Canvas of={MultiSelectStories.WithDefaultValue} sourceState="shown" />

## Retningslinjer

- Det kan være lurt å lagre kladd av input i skjemaet brukeren fyller ut.
